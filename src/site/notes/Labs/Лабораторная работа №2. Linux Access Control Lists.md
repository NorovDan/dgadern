---
{"dg-publish":true,"permalink":"/labs/laboratornaya-rabota-2-linux-access-control-lists/"}
---



---

**ФИО:** 2022-ФГиИБ-ИБ-1б Воронов Даниил Алексеевич 

---
![Pasted image 20250217224529.png](/img/user/Pasted%20image%2020250217224529.png)
<div style="text-align: center;">
  Рисунок 1 - Создание новых пользователей
</div>

![Pasted image 20250217224613.png](/img/user/Pasted%20image%2020250217224613.png)
<div style="text-align: center;">
  Рисунок 2 - Создание группу sysop и добавление туда пользователей student1 и student2 
</div>

![Pasted image 20250217224725.png](/img/user/Pasted%20image%2020250217224725.png)
<div style="text-align: center;">
  Рисунок 3 - Предоставление для группы sysop прав администрирования 
</div>

Так как начиная с версии Alpine Linux 3.16 `sudo` спрятан в репозиторий community, то используем его аналог `doas`. Через `nano /etc/doas.conf` меняем права доступа

![Pasted image 20250217225226.png](/img/user/Pasted%20image%2020250217225226.png)
<div style="text-align: center;">
  Рисунок 4 - Добавляем созданных пользователей в общую группу
</div>

![Pasted image 20250217225309.png](/img/user/Pasted%20image%2020250217225309.png)
<div style="text-align: center;">
  Рисунок 5 - Проверка групп
</div>

![Pasted image 20250217225414.png](/img/user/Pasted%20image%2020250217225414.png)
<div style="text-align: center;">
  Рисунок 6 - Изменение прав
</div>

Чтобы получить результат, который от нас требуется в задании меняем права доступа. В противном случае файл будет создаваться от группы `student3`, а не от `sysop`

![Pasted image 20250217225634.png](/img/user/Pasted%20image%2020250217225634.png)
<div style="text-align: center;">
  Рисунок 7 - Создание файла student3.script.sh
</div>

На основе примера, предоставляем для этого файла права на исполнение для владельца и группы.

Мы не можем предоставить пользователю student4 права на чтение и запись, так как это может нарушить безопасность системы, так как этот пользователь обладает пониженными привилегиями. 
### 1.Установка acl

![Pasted image 20250217230324.png](/img/user/Pasted%20image%2020250217230324.png)
<div style="text-align: center;">
  Рисунок 8 - Установка и знакомство с acl
</div>

### 2. Практика

**2.1. Изучите с помощью getfacl права файла student03.script.sh**

![Pasted image 20250217230416.png](/img/user/Pasted%20image%2020250217230416.png)
<div style="text-align: center;">
  Рисунок 9 - Проверка student3.script.sh через getfacl
</div>

**2.2. С помощью setfacl предоставьте пользователь student04 права на чтение и запись скрипты student03.script.sh**.

![Pasted image 20250217230547.png](/img/user/Pasted%20image%2020250217230547.png)
<div style="text-align: center;">
  Рисунок 10 - Изменение прав пользователя student4
</div>

`-m`: позволяет изменить права доступа
`u:student4`: указываем права какого именно пользователя мы хотим изменить
`:rw`-: устанавливаем права на чтение и запись

**2.3. В дополнение к трем пользователям из ЛР01, создайте еще двух ползователей (user4, user5). Затем создайте еще одну группу (напр. group2) и поместите в нее новых пользователей (user4, user5).**

![Pasted image 20250217230948.png](/img/user/Pasted%20image%2020250217230948.png)
<div style="text-align: center;">
  Рисунок 11 - Создание пользователей user4 и user5 и добавление их в группу group2
</div>


**2.4. Внутри директории пользователя user5 создайте от его имени директорию important_files**.

![Pasted image 20250217231256.png](/img/user/Pasted%20image%2020250217231256.png)
<div style="text-align: center;">
  Рисунок 12 - Создание директории important_files и сравнение ls -l и getfacl
</div>

В отличии от `ls -l`, `getfacl` предоставляет более подробную информацию о правах доступа

**2.5. Зайдите под четвертым (user4) (относительно пользователей из ЛР01) и выполните следующие действия:**

- Попытайтесь добавить новую директорию внутри _important_files_. Можете ли вы это сделать? Почему?

![Pasted image 20250217232220.png](/img/user/Pasted%20image%2020250217232220.png)
<div style="text-align: center;">
  Рисунок 13 - Попытка создать новую директорию
</div>
Нам мешает система контроля доступа. Хотя и user4 находится в той же группе что и user5, для системы он считается как кто-то посторонний 
- Добавьте новое **ACL** правило для директории _important_files_ такое, чтобы четвертый пользователь (user4) имел права `rwx`;

![Pasted image 20250217232813.png](/img/user/Pasted%20image%2020250217232813.png)
<div style="text-align: center;">
  Рисунок 13 - Изменение доступа к important_files для user4
</div>

- Есть ли разница между выводом `ls -l` и `getfacl` для _important_files_? Почему?
![Pasted image 20250217233139.png](/img/user/Pasted%20image%2020250217233139.png)
<div style="text-align: center;">
  Рисунок 14 - Cравнение ls -l и getfacl
</div>

Ответ будет такой же, как и в задании 2.4

- Попытайтесь добавить новую директорию снова от имени четвертого пользователя (**user4**) внутри _important_files_. Можете ли вы это сделать? Почему?
- 
![Pasted image 20250217233422.png](/img/user/Pasted%20image%2020250217233422.png)
<div style="text-align: center;">
  Рисунок 15 - Создание директории junk
</div>

Теперь нам удалось создать директорию, так как мы изменили права доступа

**2.6. Авторизуйтесь под именем пятого пользователя (user5) и выполните следующие действия:**

- Попытайтесь создать какой-нибудь файл внутри директории четвертого пользователя из предыдущего шага. Можете ли вы это сделать? Почему?
- 
![Pasted image 20250217234009.png](/img/user/Pasted%20image%2020250217234009.png)
<div style="text-align: center;">
  Рисунок 16 - Попытка создать файл
</div>

Мы же можем этого сделать, так как у нас нет доступа

- Добавьте новое **ACL** правило для директории _important_files_ такое, чтобы группа из четвертого и пятого пользователя (group2) имела права `rwx`;

![Pasted image 20250217234545.png](/img/user/Pasted%20image%2020250217234545.png)
<div style="text-align: center;">
  Рисунок 17 - Изменение прав для important_files
</div>

- Попытайтесь создать какой-нибудь файл внутри директории четвертого пользователя из предыдущего шага. Можете ли вы это сделать? Почему?

![Pasted image 20250218000650.png](/img/user/Pasted%20image%2020250218000650.png)
<div style="text-align: center;">
  Рисунок 18 - Повторная попытка создать файл
</div>

Так как мы никак не меняли права для домашней директории user4, то мы снова не можем создать файл

**2.7. Снова авторизуйтесь под именем четвертого пользователя (user4) и создайте какой-либо файл в своей директории внутри _important_files_. Выполните следующие действия:**

![Pasted image 20250218001428.png](/img/user/Pasted%20image%2020250218001428.png)
<div style="text-align: center;">
  Рисунок 19 - Создание файла внутри директории
</div>

- Авторизуйтесь под пятым пользователем (**user5**). Можете ли вы отредактировать созданный файл? Почему?

![Pasted image 20250218001720.png](/img/user/Pasted%20image%2020250218001720.png)
<div style="text-align: center;">
  Рисунок 20 - Попытка редактирования файла
</div>

У нас нет возможности его редактирования

- Добавьте новое **ACL** правило, которое разрешало бы пользователям второй группы (**group2**) редактировать любые файлы внутри директории четвертого пользователя (**user4**) внутри **important_files**;

![Pasted image 20250218004145.png](/img/user/Pasted%20image%2020250218004145.png)
<div style="text-align: center;">
  Рисунок 21 - Изменение прав для группы group2
</div>

- Снова от имени четвертого пользователя (**user4**) создайте в описываемой директории новый файл;

![Pasted image 20250218004215.png](/img/user/Pasted%20image%2020250218004215.png)
<div style="text-align: center;">
  Рисунок 22 - Создание нового файла
</div>

- Может ли теперь пятый пользователь (user5) редактировать эти файлы? Какие? Почему?

![Pasted image 20250218004423.png](/img/user/Pasted%20image%2020250218004423.png)
<div style="text-align: center;">
  Рисунок 23 - Успешная попытка редактировать файл a.txt
</div>

![Pasted image 20250218004453.png](/img/user/Pasted%20image%2020250218004453.png)
<div style="text-align: center;">
  Рисунок 24 - Неудачная попытка редактировать файл b.txt
</div>

Не удалось редактировать файл b.txt, так как владельцем файла и группы является user4. Мы не указывали никаких прав для group2, так что для user5 доступно только чтение

**2.8. Покажите все созданные вами правила для второй группы (group2, внутри которой четвертый и пятый пользователи). Затем, удалите все эти правила.**

![Pasted image 20250218005209.png](/img/user/Pasted%20image%2020250218005209.png)
<div style="text-align: center;">
  Рисунок 25 - Созданные правила для group2
</div>

Находим файлы через флаги:
`-R`: рекурсивно
`-s`: пропуск элементов у которых стандартный набор прав


![Pasted image 20250218005500.png](/img/user/Pasted%20image%2020250218005500.png)
<div style="text-align: center;">
  Рисунок 26 - Удаление правил
</div>

**2.9. Авторизуйтесь по четвертым пользователем (user4). Создайте третий файл внутри своей директории внутри _important_files_**.

![Pasted image 20250218010017.png](/img/user/Pasted%20image%2020250218010017.png)
<div style="text-align: center;">
  Рисунок 27 - Создание файла c.txt
</div>


**2.10. Может ли теперь пятый пользователь (user5) редактировать файлы внутри директории четвертого пользователя? Какие? Почему?**

![Pasted image 20250218010212.png](/img/user/Pasted%20image%2020250218010212.png)
<div style="text-align: center;">
  Рисунок 28 - Проверка прав доступа
</div>

Так как мы удалили все правила для group2, куда входит user5, то все три созданные файла от имени user4, для user5 будут доступны лишь для чтения

**2.11. Удалите все ACL правила для директории четвертого пользователя, затем повторите предыдущий шаг. Что изменилось? Почему?**.

![Pasted image 20250218010656.png](/img/user/Pasted%20image%2020250218010656.png)
<div style="text-align: center;">
  Рисунок 29 - Проверка прав доступа директории
</div>

Так как все правила для group2 были удалены, в том числе и для директории junk. Поэтому повторение предыдущего шага не требуется