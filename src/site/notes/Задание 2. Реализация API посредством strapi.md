---
{"dg-publish":true,"permalink":"/zadanie-2-realizacziya-api-posredstvom-strapi/"}
---

**ФИО:** 2022-ФГиИБ-ИБ-1б Воронов Даниил Алексеевич 
## Чек-лист требований

- [x]  Есть скриншоты с основными ключевыми этапами;
- [x]  Скриншоты прокомментированы;
- [x]  К первому дедлайну реализована как минимум одна сущность;
- [x]  Ко второму дедлайну реализован весь проект;
- [x]  Противоречия в ТЗ (при наличии) прокомментированы;
- [x]  Отчет отформатирован.

Ссылка на техническое задание: https://my-digital-garden-phi-flame.vercel.app/
## Процесс реализации

![Pasted image 20240915164724.png](/img/user/Pasted%20image%2020240915164724.png)
<div style="text-align: center;">
  Панель администратора
</div>

После регистрации в Strapi мы попадаем в панель администратора, где будем создавать сущности и взаимодействовать с ними

### Сущность 1

![Pasted image 20240923213401.png](/img/user/Pasted%20image%2020240923213401.png)
<div style="text-align: center;">
  Сущность "Аниме"
</div>

Создаем сущность "Аниме" и добавляем в ней атрибуты. Так как в ТЗ не прописано, какие должны быть атрибуты в каждой сущности, то приходится самостоятельно их додумывать, что значительно замедляет процесс работы:
- id_anime - идентификатор аниме (Тип данных: UID)
- name - название аниме (Тип данных: Text)
- studio - название студии, которая сделала аниме(Тип данных: Text)
- genre - жанр аниме (Тип данных: Text)
- description - описание аниме (Тип данных: Text)
- rate - оценка аниме, которая составляется из количества и оценок рецензий, оценка может быть в диапазоне от 0 до 10 (Тип данных: Number)
- anime_image - постер аниме (Тип данных: Media)
- comments - связь между сущностями "Аниме" и "Комментарий" (Тип данных: Relation, Тип связи: один ко многим)
- reviews - связь между сущностями "Аниме и Рецензия" (Тип данных: Relation, Тип связи: один ко многим)
- manga - связь между сущностями "Аниме" и "Манга" (Тип данных: Relation, Тип связи: многие ко многим)

Так как в данной сущности много вложенных сущностей, то для полного заполнения этой сущности пришлось создать другие сущности, но на данном этапе дедлайна не заниматься их подробным заполнением.

![Pasted image 20240923213450.png](/img/user/Pasted%20image%2020240923213450.png)

<div style="text-align: center;">
  Пример заполнения сущности данными
</div>
#### Rest-методы

GET ../animes/{id} 
>Выводит информацию об аниме по указанному идентификатору 

![Pasted image 20240922134256.png](/img/user/Pasted%20image%2020240922134256.png)
<div style="text-align: center;">
  GET метод
</div>

POST ../animes/
>Создает новое аниме в системе

![Pasted image 20240922140851.png](/img/user/Pasted%20image%2020240922140851.png)
<div style="text-align: center;">
  POST метод
</div>

PUT ../animes/{id} 
>Изменяет информацию о существующем в системе аниме. В данном случае изменилось название студии

![Pasted image 20240922144051.png](/img/user/Pasted%20image%2020240922144051.png)
<div style="text-align: center;">
  PUT метод
</div>

DELETE ../animes/{id} 
>Удаляет аниме по идентификатору из системы

![Pasted image 20240922164157.png](/img/user/Pasted%20image%2020240922164157.png)
<div style="text-align: center;">
  DELETE метод
</div>

Все эти REST-методы могут выполняться и для других сущностей

### Трудности работы

1. Так как в ТЗ не дается четкая информация об атрибутах для каждой сущности , то приходится многое додумывать и обращаться к создателю ТЗ.
2. Было принято решение убрать возможность просмотра аниме, так как такая возможность бы слишком нагружало систему и пришлось оставить только возможность прочтения манги
3. Не указана кастомная валидация и какие атрибуты являются обязательными
4. В ТЗ отсутствуют внешние ссылки на источники с изображениями или на датасеты
5. Не указан тип медиа, который должен быть у сущностей

### Сущность 2
![Pasted image 20240922170213.png](/img/user/Pasted%20image%2020240922170213.png)
<div style="text-align: center;">
  Сущность "Манга"
</div>

Создаем сущность "Манга" и добавляем в нее атрибуты:
- id_manga - идентификатор манги (Тип данных: UID)
- manga - название манги (Тип данных:  Text)
- anime - связь между "Аниме" и "Манга" (Тип данных: Relations, Тип связи: многие ко многим)
- author - автор манги (Тип данных: Text)
- publisher - издатель манги (Тип данных: Text)
- description - описание манги (Тип данных: Text)
- rate - рейтинг манги (Тип данных: Number)
- image_manga - обложка манги (Тип данных: Media)
- genre - жанр манги (Тип данных: Text)
- comment - связь между "Манга" и "Комментарий" (Тип данных: Relations, Тип связи: один ко многим)
- review - связь между "Манга" и "Рецензия" (Тип данных: Relations, Тип связи: один ко многим)
- chapter - связь между "Манга" и "Глава" (Тип данных: Relations, Тип связи: один ко многим)
- amount_of_chapters - количество глав (Тип данных: Number)
- user - связь между "Манга" и "Пользователь" (Тип данных: Relation, Тип связи: Многие ко одному)

![Pasted image 20240922180637.png](/img/user/Pasted%20image%2020240922180637.png)
<div style="text-align: center;">
  Пример заполнения сущности данными
</div>

### Сущность 3
![Pasted image 20240922182904.png](/img/user/Pasted%20image%2020240922182904.png)
<div style="text-align: center;">
  Сущность "Глава"
</div>

Создаем сущность "Глава" и заполняем ее атрибутами:
- id_chapter - идентификатор главы (Тип данных: UID)
- comment - связь между "Глава" и "Комментарий"(Тип данных: Relations, Тип связи: один ко многим)
- review - связь между "Глава" и "Рецензия"(Тип данных: Relations, Тип связи: один ко многим)
- rate - рейтинг главы (Тип данных: Number)
- manga_itself - сама глава в виде страниц (Тип данных: Media)
- manga - связь между "Глава" и "Манга" (Тип данных: Relations, Тип связи: многие ко одному)

![Pasted image 20240922191211.png](/img/user/Pasted%20image%2020240922191211.png)
<div style="text-align: center;">
  Пример заполнения сущности данными
</div>

![Pasted image 20240922202243.png](/img/user/Pasted%20image%2020240922202243.png)
<div style="text-align: center;">
  Наполнения атрибута manga_itself
</div>

### Сущность 4

![Pasted image 20240922192055.png](/img/user/Pasted%20image%2020240922192055.png)
<div style="text-align: center;">
  Сущность "Комментарий"
</div>

Создаем сущность "Комментарий" и заполняем ее атрибутами:
- id_comment - идентификатор комментария (Тип данных: UID)
- mark - оценка комментария (Тип данных: Number)
- text - текст комментария (Тип данных: Text)
- chapter - связь между "Комментарий" и "Глава" (Тип данных: Relations, Тип связи: многие ко одному)
- anime - связь между "Комментарий" и "Аниме"  (Тип данных: Relations, Тип связи: многие ко одному)
- manga - связь между "Комментарий" и "Манга"  (Тип данных: Relations, Тип связи: многие ко одному)
- user - связь между "Комментарий" и "Пользователь" (Тип данных: Relations, Тип связи: многие ко одному)

![Pasted image 20240922194217.png](/img/user/Pasted%20image%2020240922194217.png)
<div style="text-align: center;">
  Пример заполнения сущности данными
</div>

### Сущность 5

![Pasted image 20240922195048.png](/img/user/Pasted%20image%2020240922195048.png)
<div style="text-align: center;">
  Сущность "Рецензия"
</div>

Создаем сущность "Рецензия" и заполняем ее атрибутами:
- id_review - идентификатор рецензии (Тип данных: UID)
- mark - оценка рецензии (Тип данных: Number)
- text - текст рецензии (Тип данных: Text)
- chapter - связь между "Рецензия" и "Глава" (Тип данных: Relations, Тип связи: многие ко одному)
- anime - связь между "Рецензия" и "Аниме"  (Тип данных: Relations, Тип связи: многие ко одному)
- manga - связь между "Рецензия" и "Манга"  (Тип данных: Relations, Тип связи: многие ко одному)
- user - связь между "Рецензия" и "Пользователь" (Тип данных: Relations, Тип связи: многие ко одному)

![Pasted image 20240922201423.png](/img/user/Pasted%20image%2020240922201423.png)
<div style="text-align: center;">
  Пример заполнения сущности данными
</div>

### Сущность 6
![Pasted image 20240922210805.png](/img/user/Pasted%20image%2020240922210805.png)
<div style="text-align: center;">
  Сущность "Пользователь"
</div>

В Strapi заранее есть сущность пользователь, так что просто добавляем к ней другие атрибуты:
- username - имя пользователя (Тип данных: Text)
- email - электронная почта пользователя (Тип данных: Email)
- provider -  указывает, откуда пришел пользователь. Например, это может быть стандартная аутентификация через Strapi или через сторонние провайдеры (Тип данных: Text)
- password - пароль к учетной записи пользователя (Тип данных: Password)
- resetPasswordToken - токен, который используется для сброса пароля(Тип данных: Text)
- confirmationToken - токен, который используется для подтверждения адреса электронной почты пользователя после регистрации (Тип данных: Text)
- confirmed - логическое значение (true/false), указывающее, подтвердил ли пользователь свой адрес электронной почты. Если значение false, это значит, что пользователь еще не подтвердил свою учетную запись. (Тип данных: Boolean)
- blocked - логическое значение (true/false), указывающее, заблокирован ли пользователь. Если значение true, это может означать, что пользователь не может войти в систему (Тип данных: Boolean)
- role - роль пользователя в системе (Тип данных: Relations)
- reviews - связь между "Пользователь" и "Рецензия" (Тип данных: Relations, Тип связи: один ко многим)
- comment - связь между "Пользователь" и "Комментарий" (Тип данных: Relations, Тип связи: один ко многим)
- manga - связь между "Пользователь" и "Манга" (Тип данных: Relations, Тип связи: один ко многим)

![Pasted image 20240922224757.png](/img/user/Pasted%20image%2020240922224757.png)
<div style="text-align: center;">
  Пример заполнения сущности данными
</div>

Переходим в настройки и настраиваем возможности авторизованных и неавторизованных пользователей

![Pasted image 20240922225914.png](/img/user/Pasted%20image%2020240922225914.png)
<div style="text-align: center;">
  Возможности неавторизованного пользователя
</div>

Неавторизованный пользователь может только читать мангу, комментарии и рецензии пользователей

![Pasted image 20240922231711.png](/img/user/Pasted%20image%2020240922231711.png)
<div style="text-align: center;">
  Возможности авторизованного пользователя
</div>

Авторизованный пользователь может читать мангу, а также писать, изменять и удалить свои комментарии и рецензии